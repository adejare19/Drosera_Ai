<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Drosera PoC Guide ‚Äî File Setup (Wizard)</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="captain.css">

    <style>
        /* --- General Layout & Colors --- */
        .cmd-pre {
            position: relative;
            padding-right: 110px;
        }

        .copy-btn-inline {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 2;
        }

        /* The setup.js script controls which step is visible by managing the 'active' class on the guide-section itself. 
           We don't need the individual .step classes anymore, as the content is dynamically re-rendered by renderCurrentStep().
        */

        .file-code-block {
            margin-top: 12px;
            background: #0f0f0f;
            border-radius: 8px;
            padding: 12px;
            border: 1px solid #333;
        }

        .file-code-title {
            color: #ff6600;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .wizard-controls {
            margin-top: 14px;
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .step-card {
            background: rgba(24, 24, 24, 0.85);
            padding: 30px;
            border-radius: 16px;
            max-width: 1100px;
            margin: 40px auto;
            position: relative;
            z-index: 1;
            color: #fff;
        }

        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 0;
        }

        .top-2 {
            margin-top: 0;
            font-weight: 600;
        }

        .small-muted {
            font-size: 0.95rem;
            color: #ccc;
        }

        /* --- Troubleshooting Styles --- */
        textarea {
            width: 100%;
            padding: 8px;
            background: #1a1a1a;
            color: #fff;
            border: 1px solid #333;
            border-radius: 6px;
            font-family: monospace;
        }

        .troubleshoot-section h4 {
            margin-top: 0;
        }
    </style>
</head>

<body>
    <canvas id="bg-canvas"></canvas>

    <div class="step-card">
        <button class="btn btn-link text-light p-0 mb-3" title="Back to Start" onclick="goToStep(1)">&larr; Back</button>
        <h2 class="top-2">Drosera AI PoC Guide</h2>
        <p class="small-muted">
            Step-by-step file setup (terminal-friendly). Follow each step and click <strong>Next</strong> to proceed.
        </p>

        <div class="d-flex flex-wrap gap-4">
            
            <div class="guide-section flex-grow-1" style="min-width: 60%;">
                
                <div id="guide-steps-container">
                    <p class="" id="loading-message">‚è≥ Jake is consulting...</p>
                </div>
                
                <div class="wizard-controls" id="wizard-controls" style="display:none;">
                    <button class="btn btn-secondary" id="prev-btn" onclick="prevStep()" disabled>&larr; Back</button>
                    <button class="btn btn-warning" id="next-btn" onclick="nextStep()">Yes, Proceed &rarr;</button>
                </div>
            </div>
            
            <div class="troubleshoot-section flex-grow-1" style="min-width: 35%;">
                <h4>Troubleshooting</h4>
                <textarea id="errorInput" rows="6" placeholder="Paste error output or describe where you're stuck..."></textarea>

                <div class="ai-response mt-2" id="aiResponse">
                    Copy the step instructions on the left and run them. If an error occurs, paste it here and click
                    <strong>Ask AI</strong>.
                </div>

                <div class="mt-3 d-flex gap-2">
                    <button class="btn btn-sm btn-secondary" onclick="askAI()">Ask AI</button>
                    <button class="btn btn-sm btn-light" onclick="clearError()">Clear</button>
                </div>

                <div class="ai-explanation mt-3" id="aiExplain">
                    <strong>Tips:</strong> Replace placeholders like
                    <code>YOUR_RPC_URL</code> and <code>YOUR_PRIVATE_KEY</code>
                    before running deployment commands. Never paste your private key into public chat boxes.
                </div>
            </div>
        </div>
        </div>




    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="successToast" class="toast text-bg-success" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="4000">
            <div class="toast-header">
                <strong class="me-auto">Success!</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toast-body-text">
                Setup complete. Monitoring is ready to begin!
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="setup.js"></script>

    <script>
        const canvas = document.getElementById('bg-canvas'),
          ctx = canvas.getContext('2d');

        function resetCanvas() { canvas.width = innerWidth; canvas.height = innerHeight; }
        window.addEventListener('resize', () => { resetCanvas(); initParticles(); });
        resetCanvas();

        let particles = [];
        class Particle {
          constructor(x, y, s, sx, sy) { Object.assign(this, { x, y, size: s, sx, sy }); }
          update() { this.x += this.sx; this.y += this.sy; if (this.x < 0 || this.x > canvas.width) this.sx *= -1; if (this.y < 0 || this.y > canvas.height) this.sy *= -1; }
          draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fillStyle = 'rgba(255,102,0,0.7)'; ctx.fill(); }
        }
        function initParticles() {
          particles = [];
          for (let i = 0; i < 50; i++) {
            particles.push(new Particle(
              Math.random() * canvas.width,
              Math.random() * canvas.height,
              Math.random() * 3 + 2,
              (Math.random() - 0.5) * 2,
              (Math.random() - 0.5) * 2
            ));
          }
        }
        function animate() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          particles.forEach(p => { p.update(); p.draw(); });
          for (let a = 0; a < particles.length; a++) {
            for (let b = a; b < particles.length; b++) {
              const dx = particles[a].x - particles[b].x,
                dy = particles[a].y - particles[b].y,
                d = Math.sqrt(dx * dx + dy * dy);
              if (d < 120) {
                ctx.beginPath();
                ctx.strokeStyle = 'rgba(255,102,0,0.12)';
                ctx.moveTo(particles[a].x, particles[a].y);
                ctx.lineTo(particles[b].x, particles[b].y);
                ctx.stroke();
              }
            }
          }
          requestAnimationFrame(animate);
        }
        initParticles(); animate();
    </script>


<div class="modal fade" id="githubModal" tabindex="-1" aria-labelledby="githubModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content text-bg-dark">
            <div class="modal-header">
                <h5 class="modal-title text-warning" id="githubModalLabel">üéâ Project Deployed! Now Upload to GitHub</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>
                    Your Drosera Trap project is deployed and configured on your VPS. The final step for review and sharing is to push your local code repository to a GitHub repository.
                    Follow these steps **from within your project directory** (e.g., <code>cd LiquiditySnapshotTrap</code>).
                </p>

                <div class="table-responsive">
                    <table class="table table-dark table-striped table-bordered align-middle">
                        <thead>
                            <tr>
                                <th scope="col">Step</th>
                                <th scope="col" style="width: 25%;">Action</th>
                                <th scope="col">Command</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>**1.**</td>
                                <td>Initialize Git</td>
                                <td><code>git init</code></td>
                            </tr>
                            <tr>
                                <td>**2.**</td>
                                <td>Stage All Files</td>
                                <td><code>git add .</code></td>
                            </tr>
                            <tr>
                                <td>**3.**</td>
                                <td>Create Commit</td>
                                <td><code>git commit -m "Initial Drosera Trap deployment"</code></td>
                            </tr>
                            <tr>
                                <td>**4.**</td>
                                <td>Link Remote</td>
                                <td><code>git remote add origin [YOUR_GITHUB_REPO_URL]</code></td>
                            </tr>
                            <tr>
                                <td>**5.**</td>
                                <td>Push Code</td>
                                <td><code>git push -u origin main</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h6 class="mt-4 text-warning">‚ö†Ô∏è Important Note:</h6>
                <ul class="small">
                    <li>**GitHub Token:** If you use two-factor authentication (2FA), you must use a **GitHub Personal Access Token (PAT)** instead of your password during the <code>git push</code>.</li>
                    <li>**Empty Repo:** Ensure the GitHub repository you link to is **empty** (no `README.md` or `.gitignore` added by GitHub) to avoid merge conflicts on the first push.</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-warning" data-bs-dismiss="modal">Close & Finish</button>
            </div>
        </div>
    </div>
</div>
</body>

</html>